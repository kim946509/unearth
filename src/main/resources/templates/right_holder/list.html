<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>UNEARTH | 권리자 등록</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/right_holder.css">
</head>
<body>
<div th:replace="~{common/header :: header}"></div>
<div class="main-container">
    <div th:replace="~{common/sidebar :: sidebar}"></div>
    <section class="content">
        <form class="search-form" method="get" th:action="@{/right-holder/list}">
            <div class="search-row">
                <div class="search-group">
                    <label>구분</label>
                    <select name="holderType" class="search-input">
                        <option value="" th:selected="${holderType == null}">전체</option>
                        <option value="PERSONAL" th:selected="${holderType == 'PERSONAL'}">개인</option>
                        <option value="BUSINESS" th:selected="${holderType == 'BUSINESS'}">사업자</option>
                    </select>
                </div>
                <div class="search-group">
                    <label>권리자명</label>
                    <input type="text" name="holderName" class="search-input" th:value="${holderName}" placeholder="권리자명 입력" />
                </div>
                <div class="search-group">
                    <label>계약 기간</label>
                    <input type="date" name="contractDate" class="search-input" th:value="${contractDate}" />
                </div>
                <div class="search-group">
                    <label>페이지당 개수</label>
                    <select name="size" class="search-input">
                        <option th:value="10" th:selected="${size == 10}">10</option>
                        <option th:value="30" th:selected="${size == 30}">30</option>
                        <option th:value="50" th:selected="${size == 50}">50</option>
                    </select>
                </div>
                <div class="search-group search-btn-group">
                    <button type="submit" class="search-btn">검색</button>
                </div>
                <div class="search-group register-btn-group">
                    <a th:href="@{/right-holder/register}" class="register-btn">권리자 등록하기</a>
                </div>
            </div>
        </form>
        <!-- 안내문구 영역 -->
        <div th:if="${response.code != 'SUCCESS' and response.message != null and !#strings.isEmpty(response.message)}" class="error-message" th:text="${response.message}"></div>
        <table class="holder-table">
            <thead>
            <tr>
                <th>구분</th>
                <th>권리자명</th>
                <th>계약 기간</th>
                <th>등록 곡 수</th>
                <th>권리자 페이지</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="holder : ${response.data.content}">
                <td th:text="${holder.holderType == 'PERSONAL' ? '개인' : '사업자'}"></td>
                <td th:text="${holder.holderName}"></td>
                <td th:text="${holder.contractStart} + '~' + ${holder.contractEnd}"></td>
                <td th:text="${#numbers.formatInteger(holder.songCount, 0, 'COMMA')}"></td>
                <td><a th:href="@{'/right-holder/' + ${holder.holderId}}" class="move-btn">이동</a></td>
            </tr>
            <tr th:if="${response.data.content.size() == 0}">
                <td colspan="5" style="text-align:center;">권리자가 없습니다.</td>
            </tr>
            </tbody>
        </table>
        <div class="pagination">
            <a th:if="${response.data.hasPrevious()}" th:href="@{/right-holder/list(page=${response.data.number - 1}, size=${size}, holderType=${param.holderType}, holderName=${param.holderName}, contractDate=${param.contractDate})}" class="page-btn">이전</a>
            <span th:each="i : ${#numbers.sequence(0, response.data.totalPages - 1)}">
                <a th:if="${i != response.data.number}" th:href="@{/right-holder/list(page=${i}, size=${size}, holderType=${param.holderType}, holderName=${param.holderName}, contractDate=${param.contractDate})}" th:text="${i + 1}" class="page-btn"></a>
                <span th:if="${i == response.data.number}" th:text="${i + 1}" class="page-btn current"></span>
            </span>
            <a th:if="${response.data.hasNext()}" th:href="@{/right-holder/list(page=${response.data.number + 1}, size=${size}, holderType=${param.holderType}, holderName=${param.holderName}, contractDate=${param.contractDate})}" class="page-btn">다음</a>
        </div>
    </section>
</div>
</body>
</html> 